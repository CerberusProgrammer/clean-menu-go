{{define "title"}} Edit Menu {{end}}
{{define "main"}}
<div class="container mx-auto px-6 py-8">
    <h1 class="text-3xl font-bold mb-6">Edit Menu</h1>
    <form action="/menus/edit" method="POST" class="space-y-6">
        <input type="hidden" name="id" value="{{.ID}}">
        <div>
            <label for="name" class="block text-sm font-medium text-gray-700">Name</label>
            <input type="text" name="name" id="name" value="{{.Name}}" required
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">
        </div>
        <div>
            <label for="price" class="block text-sm font-medium text-gray-700">Price</label>
            <input type="number" step="0.01" name="price" id="price" value="{{.Price}}" required
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">
        </div>
        <div>
            <label for="recipe" class="block text-sm font-medium text-gray-700">Recipe</label>
            <textarea name="recipe" id="recipe"
                class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">{{.Recipe}}</textarea>
        </div>
        <div>
            <label for="category" class="block text-sm font-medium text-gray-700">Categories</label>
            <div class="flex space-x-2">
                <input type="text" id="category-input"
                    class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">
                <button type="button" onclick="addCategory()"
                    class="bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary transition duration-300 ease-in-out">Add</button>
            </div>
            <div id="categories-list" class="mt-2 flex flex-wrap space-x-2">
                {{range .Categories}}
                <span class="bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-sm"
                    onclick="removeCategory(this)">{{.}}</span>
                {{end}}
            </div>
            <input type="hidden" name="categories" id="categories" value="{{join .Categories " ,"}}">
        </div>
        <div>
            <button type="submit"
                class="bg-primary text-white px-4 py-2 rounded-md hover:bg-secondary transition duration-300 ease-in-out">Update</button>
        </div>
    </form>
</div>

<script>
    function addCategory() {
        const categoryInput = document.getElementById('category-input');
        const categoriesList = document.getElementById('categories-list');
        const categoriesField = document.getElementById('categories');

        if (categoryInput.value.trim() !== '') {
            const category = categoryInput.value.trim();
            const categoryElement = document.createElement('span');
            categoryElement.className = 'bg-gray-200 text-gray-700 px-2 py-1 rounded-full text-sm';
            categoryElement.innerText = category;
            categoryElement.onclick = function () {
                categoriesList.removeChild(categoryElement);
                updateCategoriesField();
            };
            categoriesList.appendChild(categoryElement);
            updateCategoriesField();
            categoryInput.value = '';
        }
    }

    function updateCategoriesField() {
        const categoriesList = document.getElementById('categories-list');
        const categoriesField = document.getElementById('categories');
        const categories = [];
        categoriesList.childNodes.forEach(function (categoryElement) {
            categories.push(categoryElement.innerText);
        });
        categoriesField.value = categories.join(',');
    }

    function removeCategory(element) {
        const categoriesList = document.getElementById('categories-list');
        categoriesList.removeChild(element);
        updateCategoriesField();
    }
</script>
{{end}}